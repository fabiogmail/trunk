<?xml version = '1.0' encoding = 'UTF-8'?>
<TableView class="oracle.dbtools.crest.model.design.relational.TableView" directorySegmentName="seg_0" id="1CC6C354-5586-5DCB-1FC9-295AAE3B1028" name="VIEW_SMP7_PAINEL_ACOMP">
<createdBy>osx</createdBy>
<createdTime>2013-11-25 17:38:38 UTC</createdTime>
<generatorID>Gerado pelo usu√°rio</generatorID>
<ownerDesignName>metricView</ownerDesignName>
<afterCreate>CREATE OR REPLACE FORCE VIEW &quot;EASYVIEW&quot;.&quot;VIEW_SMP7_PAINEL_ACOMP&quot; (&quot;DATA&quot;, &quot;PMM&quot;, &quot;SMP7&quot;, &quot;CN&quot;) AS &lt;br/&gt;  WITH dados_traducao_sem_vinculo as (select DATA, HORA, PMM, CN, MSC, OK1_DRP, OK1_DRP_TCT, OKT, OK_ITCP  from view_msc_vinculo_smp7 where codigo != &apos;NID&apos;&lt;br/&gt;    &lt;br/&gt;  ),Dias AS&lt;br/&gt;  (SELECT UNIQUE TO_CHAR(Dt.DATA, &apos;dd&apos;) AS Data&lt;br/&gt;  FROM CDRVIEW_SMP7 Dt&lt;br/&gt;  WHERE TO_CHAR(Dt.DATA, &apos;dd&apos;) &gt;= 1&lt;br/&gt;  AND TO_CHAR(Dt.DATA, &apos;dd&apos;)   &lt;= 10&lt;br/&gt;  ),&lt;br/&gt;  MesAno AS&lt;br/&gt;  (SELECT UNIQUE TO_CHAR(Dt.DATA, &apos;mm/yyyy&apos;) AS Data FROM CDRVIEW_SMP7 Dt&lt;br/&gt;  ),&lt;br/&gt;  Dia_X_Mes_X_Ano AS&lt;br/&gt;  (SELECT Concat(Concat(Dias.Data, &apos;/&apos;), Mesano.Data) AS data&lt;br/&gt;  FROM Dias Dias,&lt;br/&gt;    Mesano Mesano&lt;br/&gt;  ),&lt;br/&gt;  Smps_dados AS&lt;br/&gt;  (SELECT Data  AS DATA,&lt;br/&gt;    Pmm         AS PMM,&lt;br/&gt;    TO_CHAR(CN) AS CN,&lt;br/&gt;    CASE&lt;br/&gt;      WHEN SMP7_B = &apos;-&apos;&lt;br/&gt;      AND Smp7_A  = &apos;-&apos;&lt;br/&gt;      THEN &apos;-&apos;&lt;br/&gt;      WHEN (SMP7_B = &apos;-&apos;&lt;br/&gt;      OR SMP7_B    = &apos;0&apos;)&lt;br/&gt;      AND Smp7_A  != &apos;-&apos;&lt;br/&gt;      THEN &apos;0,00&apos;&lt;br/&gt;      WHEN SMP7_B           != &apos;-&apos;&lt;br/&gt;      AND TO_NUMBER(SMP7_B) &gt;= 0&lt;br/&gt;      AND Smp7_A             = &apos;-&apos;&lt;br/&gt;      THEN &apos;0,00&apos;&lt;br/&gt;      ELSE NVL(trim(TO_CHAR(ROUND(((SMP7_A / SMP7_B) * 100),2),&apos;999990D99&apos;)), &apos;-&apos;)&lt;br/&gt;    END AS Smp7&lt;br/&gt;  FROM&lt;br/&gt;    (SELECT TRUNC(Tab.DATA) AS Data,&lt;br/&gt;      pmm.NOME              AS Pmm,&lt;br/&gt;      Tab.CN,&lt;br/&gt;      NVL(TO_CHAR(SUM(NVL(Tab.OK1_DRP, 0) + NVL(Tab.OK1_DRP_TCT, 0))), &apos;-&apos;) AS Smp7_A,&lt;br/&gt;      NVL(TO_CHAR(SUM(NVL(Tab.OKT, 0)     - NVL(Tab.OK_ITCP, 0))), &apos;-&apos;)     AS SMP7_B&lt;br/&gt;    FROM &lt;br/&gt;    view_msc_cn_ativo_smp7 b,&lt;br/&gt;    dados_traducao_sem_vinculo Tab&lt;br/&gt;    INNER JOIN PMM pmm&lt;br/&gt;    ON Tab.HORA BETWEEN pmm.INICIO AND pmm.FIM&lt;br/&gt;    WHERE TO_CHAR(Tab.DATA, &apos;dd&apos;) IN&lt;br/&gt;      (SELECT Dias.Data FROM Dias&lt;br/&gt;      )&lt;br/&gt;      and tab.msc = b.msc&lt;br/&gt;      and tab.cn = b.cn&lt;br/&gt;      and to_date(to_char(tab.data,&apos;MM/yyyy&apos;),&apos;MM/yyyy&apos;) = b.periodo&lt;br/&gt;      and b.status = &apos;T&apos;&lt;br/&gt;    GROUP BY TRUNC(Tab.DATA),&lt;br/&gt;      pmm.NOME,&lt;br/&gt;      Tab.CN&lt;br/&gt;    )&lt;br/&gt;  ),&lt;br/&gt;  Dias_X_Cn_X_Pmm AS&lt;br/&gt;  (SELECT to_date(D.data, &apos;dd/mm/yyyy&apos;) AS Data,&lt;br/&gt;    Cn.nome,&lt;br/&gt;    Pmm.NOME AS Pmm&lt;br/&gt;  FROM CN Cn,&lt;br/&gt;    Dia_X_Mes_X_Ano D,&lt;br/&gt;    PMM Pmm&lt;br/&gt;  ),&lt;br/&gt;  Dias_X_Cn_X_Pmm_X_Smp AS&lt;br/&gt;  (SELECT NVL(TRUNC(Smpdados.DATA), Diascnpmm.Data) AS Data,&lt;br/&gt;    Diascnpmm.Pmm,&lt;br/&gt;    NVL(Smpdados.Smp7, &apos;-&apos;) AS Smp7,&lt;br/&gt;    Diascnpmm.nome          AS Cn&lt;br/&gt;  FROM Dias_X_Cn_X_Pmm Diascnpmm,&lt;br/&gt;    Smps_Dados Smpdados&lt;br/&gt;  WHERE TRUNC(Diascnpmm.Data) = TRUNC(Smpdados.DATA(+))&lt;br/&gt;  AND Diascnpmm.Pmm           = Smpdados.PMM(+)&lt;br/&gt;  AND Diascnpmm.nome          = Smpdados.CN(+)&lt;br/&gt;  )&lt;br/&gt;SELECT TO_CHAR(Dias_X_Cn_X_Pmm_X_Smp.Data, &apos;DD/MM/YYYY&apos;) AS DATA,&lt;br/&gt;  Dias_X_Cn_X_Pmm_X_Smp.Pmm,&lt;br/&gt;  replace(Dias_X_Cn_X_Pmm_X_Smp.Smp7,&apos;.&apos;,&apos;,&apos;) as smp7,&lt;br/&gt;  TO_CHAR(Dias_X_Cn_X_Pmm_X_Smp.Cn) AS CN&lt;br/&gt;FROM Dias_X_Cn_X_Pmm_X_Smp&lt;br/&gt;ORDER BY TO_CHAR(Dias_X_Cn_X_Pmm_X_Smp.Cn),&lt;br/&gt;  TO_CHAR(Dias_X_Cn_X_Pmm_X_Smp.Data, &apos;DD/MM/YYYY&apos;),&lt;br/&gt;  Dias_X_Cn_X_Pmm_X_Smp.Pmm;</afterCreate>
<shouldGeneratescript>true</shouldGeneratescript>
<userDefined>true</userDefined>
<layoutSQL>&lt;?xml version = &apos;1.0&apos; encoding = &apos;UTF-8&apos;?&gt;&lt;br&gt;&lt;ActiveQueryBuilderLayout&gt;&lt;SQL&gt;Select * From&lt;/SQL&gt;&lt;SubQueries&gt;&lt;SubQuery SQL=&quot;Select * From&quot;&gt;&lt;UnionSubQuery/&gt;&lt;/SubQuery&gt;&lt;/SubQueries&gt;&lt;/ActiveQueryBuilderLayout&gt;</layoutSQL>
<parsed>true</parsed>
<schemaObject>4557F491-498C-47A4-4FCC-3C34A06925BD</schemaObject>
</TableView>